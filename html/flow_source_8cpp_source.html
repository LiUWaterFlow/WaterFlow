<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Waterflow: src/flowSource.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Waterflow
   
   </div>
   <div id="projectbrief">Visualize water in terrain</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('flow_source_8cpp.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">src/flowSource.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;<a class="code" href="flow_source_8h.html" title="Contains class specifing a flow source and its parameters.">flowSource.h</a>&quot;</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">// This file contains the implementation for the methods of the flowSource class</span>
<a name="l00004"></a>00004 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">// This functoin expects pressure and time values in two seperates vectors with a N to N corespondence,</span>
<a name="l00007"></a>00007 <span class="comment">// where N is the vector position.</span>
<a name="l00008"></a>00008 <span class="comment">// For example P = [1.5 , 2.1, 1.7] time = [1, 3, 8] gives that the pressure is 2.1 between the time 1 and 3.</span>
<a name="l00009"></a>00009 <span class="comment">// The time vector most be sorted from smalest element to largest.</span>
<a name="l00010"></a><a class="code" href="class_flow_source.html#a52620b99484ff3d28cab045b9c3e831a">00010</a> <span class="keywordtype">void</span> <a class="code" href="class_flow_source.html#a52620b99484ff3d28cab045b9c3e831a" title="Sets the pressure vector and the pressure time vector. This functoin expects pressure and time values...">FlowSource::setPressure</a>(std::vector&lt;float&gt; P, std::vector&lt;float&gt; time){
<a name="l00011"></a>00011   <a class="code" href="class_flow_source.html#a2d84b034ba95f365e185cf25b5ebd6cb" title="Vector containing pressure values.">pressure</a> = P;
<a name="l00012"></a>00012   <a class="code" href="class_flow_source.html#abe1e9b1f66c59188326167d1059d0e0b" title="&quot;-1&quot; specifies an infinite source.">pressureTime</a> = time;
<a name="l00013"></a>00013 }
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">// This function expects a vector filled with vectors that hold 3 values, xyz, and a time vector that specifies when to change the Normal direction. this time vector can be independent from the one used for pressure.</span>
<a name="l00017"></a><a class="code" href="class_flow_source.html#a5bad4132d2adcd6c0661bf7d06f71b28">00017</a> <span class="keywordtype">void</span> <a class="code" href="class_flow_source.html#a5bad4132d2adcd6c0661bf7d06f71b28" title="This function expects a vector filled with vectors that hold 3 values, xyz, and a time vector that sp...">FlowSource::setNormal</a>(std::vector&lt; std::vector&lt;float&gt; &gt; N, std::vector&lt;int&gt; time){
<a name="l00018"></a>00018   <a class="code" href="class_flow_source.html#a3b2c09672dc3ff5acd79cdf1c5cd034c" title="Vector of vectors containing normal direction as xyz.">normal</a> = N;
<a name="l00019"></a>00019   <a class="code" href="class_flow_source.html#a7881befa051a1e5c2238a65ecec851f4" title="&quot;-1&quot; specifies an infinite source.">normalTime</a> = time;
<a name="l00020"></a>00020 }
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">// This function expects three ints symbolizing the 3D space cordinates of the source expressed in voxels</span>
<a name="l00023"></a><a class="code" href="class_flow_source.html#aecc7891570af30b5fc70dfe8bfd4637b">00023</a> <span class="keywordtype">void</span> <a class="code" href="class_flow_source.html#aecc7891570af30b5fc70dfe8bfd4637b" title="This function expects three ints symbolizing the 3D space cordinates of the source expressed in voxel...">FlowSource::setPosition</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> z){
<a name="l00024"></a>00024   <a class="code" href="class_flow_source.html#adb3bdaeaf28846562dcd80f42707e417" title="The x position of the source.">xpos</a>=x;
<a name="l00025"></a>00025   <a class="code" href="class_flow_source.html#acbe39fd6b4c3df0fe26325edcc39c8a8" title="The y position of the source.">ypos</a>=y;
<a name="l00026"></a>00026   <a class="code" href="class_flow_source.html#a9635d50a05d0cb2f89f3380bb59fc6a5" title="The z position of the source.">zpos</a>=z;
<a name="l00027"></a>00027 }
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// This simply sets a float symbolising the total water in a source, no method changing this parameter has been implemented yet.</span>
<a name="l00030"></a><a class="code" href="class_flow_source.html#a95330ff99fa4812be760dbdc7f94a716">00030</a> <span class="keywordtype">void</span> <a class="code" href="class_flow_source.html#a95330ff99fa4812be760dbdc7f94a716" title="This sets a float symbolising the total water in a source.">FlowSource::setTotalWater</a>(<span class="keywordtype">float</span> waterAmount){
<a name="l00031"></a>00031   <a class="code" href="class_flow_source.html#a7a4d74ebd43f9bc207833411a70f433a" title="The total water of the source.">totalWater</a> = waterAmount;
<a name="l00032"></a>00032 }
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="class_flow_source.html#ac1a40c4629c8dcd35ddc693858167f09">00035</a> <span class="keywordtype">void</span> <a class="code" href="class_flow_source.html#ac1a40c4629c8dcd35ddc693858167f09" title="Sets the radius of the source.">FlowSource::setRadius</a>(<span class="keywordtype">float</span> r){
<a name="l00036"></a>00036   <a class="code" href="class_flow_source.html#a0fa7b53fc621d46afbe53125fec56ab7" title="The radius of the source.">radius</a> = r;
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">// This function updates the internal time of the source idealy this should be called att constant intervals e.g. onece evry loop of simulation. It could be expanded with calculating remaining water.</span>
<a name="l00040"></a><a class="code" href="class_flow_source.html#a70cbe7c173437ef03d7eec12f500199d">00040</a> <span class="keywordtype">void</span> <a class="code" href="class_flow_source.html#a70cbe7c173437ef03d7eec12f500199d" title="This function updates the source by progressing the internal source time. this should be called regul...">FlowSource::update</a>(<span class="keywordtype">float</span> <a class="code" href="field_shader_8comp.html#a97357e98eaffc814a4a8996e8811ee20" title="timestep for simulation.">dt</a>){
<a name="l00041"></a>00041   <a class="code" href="class_flow_source.html#abf058a78d303e23fa3a0bf7da10e24cb" title="The current internal source time, this should be linear maped to simulation time.">currTime</a> = <a class="code" href="class_flow_source.html#abf058a78d303e23fa3a0bf7da10e24cb" title="The current internal source time, this should be linear maped to simulation time.">currTime</a> + <a class="code" href="field_shader_8comp.html#a97357e98eaffc814a4a8996e8811ee20" title="timestep for simulation.">dt</a>;
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// This function returns the curent pressure depending on the internal time set by the update function.</span>
<a name="l00045"></a><a class="code" href="class_flow_source.html#a8bfe33f49781c093cdee9fef53270393">00045</a> <span class="keywordtype">float</span> <a class="code" href="class_flow_source.html#a8bfe33f49781c093cdee9fef53270393" title="This function finds the curent pressure depandeing on the internal time set by the update function...">FlowSource::getPressure</a>(){
<a name="l00046"></a>00046  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currItr = 0;
<a name="l00047"></a>00047   <span class="keywordflow">for</span>(<span class="keyword">auto</span> i = <a class="code" href="class_flow_source.html#abe1e9b1f66c59188326167d1059d0e0b" title="&quot;-1&quot; specifies an infinite source.">pressureTime</a>.begin(); i !=<a class="code" href="class_flow_source.html#abe1e9b1f66c59188326167d1059d0e0b" title="&quot;-1&quot; specifies an infinite source.">pressureTime</a>.end(); ++i){
<a name="l00048"></a>00048     <span class="keywordflow">if</span>( *i &lt; <a class="code" href="class_flow_source.html#abf058a78d303e23fa3a0bf7da10e24cb" title="The current internal source time, this should be linear maped to simulation time.">currTime</a>) currItr++;
<a name="l00049"></a>00049     <span class="keywordflow">else</span> <span class="keywordflow">break</span>;
<a name="l00050"></a>00050   }
<a name="l00051"></a>00051   <span class="keywordflow">if</span> (currItr &lt; <a class="code" href="class_flow_source.html#abe1e9b1f66c59188326167d1059d0e0b" title="&quot;-1&quot; specifies an infinite source.">pressureTime</a>.size())
<a name="l00052"></a>00052     <span class="keywordflow">return</span> <a class="code" href="class_flow_source.html#a2d84b034ba95f365e185cf25b5ebd6cb" title="Vector containing pressure values.">pressure</a>.at(currItr);
<a name="l00053"></a>00053   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_flow_source.html#abe1e9b1f66c59188326167d1059d0e0b" title="&quot;-1&quot; specifies an infinite source.">pressureTime</a>.back() == -1)
<a name="l00054"></a>00054     <span class="keywordflow">return</span> <a class="code" href="class_flow_source.html#a2d84b034ba95f365e185cf25b5ebd6cb" title="Vector containing pressure values.">pressure</a>.back();
<a name="l00055"></a>00055   <span class="keywordflow">else</span>
<a name="l00056"></a>00056     <span class="keywordflow">return</span> 0;
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">// This function returns a thee valued vector with xyz defining the Normal direction at the internal time specified by the update function.</span>
<a name="l00060"></a><a class="code" href="class_flow_source.html#a9c25ddeeba1243c9255c015ae2b47801">00060</a> std::vector&lt;float&gt; <a class="code" href="class_flow_source.html#a9c25ddeeba1243c9255c015ae2b47801" title="This function finds a thee valued vector with xyz defining the Normal direction at the internal time ...">FlowSource::getNormal</a>(){  
<a name="l00061"></a>00061   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> currItr = 0;
<a name="l00062"></a>00062   std::vector&lt;float&gt; err = {0, 0, 0};
<a name="l00063"></a>00063   <span class="keywordflow">for</span>(<span class="keyword">auto</span> i = <a class="code" href="class_flow_source.html#a7881befa051a1e5c2238a65ecec851f4" title="&quot;-1&quot; specifies an infinite source.">normalTime</a>.begin(); i !=<a class="code" href="class_flow_source.html#a7881befa051a1e5c2238a65ecec851f4" title="&quot;-1&quot; specifies an infinite source.">normalTime</a>.end(); ++i){
<a name="l00064"></a>00064     <span class="keywordflow">if</span>( *i &lt;= <a class="code" href="class_flow_source.html#abf058a78d303e23fa3a0bf7da10e24cb" title="The current internal source time, this should be linear maped to simulation time.">currTime</a>) currItr++;
<a name="l00065"></a>00065     <span class="keywordflow">else</span> <span class="keywordflow">break</span>;
<a name="l00066"></a>00066   }
<a name="l00067"></a>00067   <span class="keywordflow">if</span> (currItr &lt; <a class="code" href="class_flow_source.html#a7881befa051a1e5c2238a65ecec851f4" title="&quot;-1&quot; specifies an infinite source.">normalTime</a>.size())
<a name="l00068"></a>00068     <span class="keywordflow">return</span> <a class="code" href="class_flow_source.html#a3b2c09672dc3ff5acd79cdf1c5cd034c" title="Vector of vectors containing normal direction as xyz.">normal</a>.at(currItr);
<a name="l00069"></a>00069   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_flow_source.html#a7881befa051a1e5c2238a65ecec851f4" title="&quot;-1&quot; specifies an infinite source.">normalTime</a>.back() == -1)
<a name="l00070"></a>00070     <span class="keywordflow">return</span> <a class="code" href="class_flow_source.html#a3b2c09672dc3ff5acd79cdf1c5cd034c" title="Vector of vectors containing normal direction as xyz.">normal</a>.back();
<a name="l00071"></a>00071   <span class="keywordflow">else</span>
<a name="l00072"></a>00072     <span class="keywordflow">return</span> err;
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="comment">// This returns the position as a three valued vector containing xyz.</span>
<a name="l00076"></a><a class="code" href="class_flow_source.html#a3cf14642f55c4d082a1ba91d2948fa92">00076</a> std::vector&lt;int&gt; <a class="code" href="class_flow_source.html#a3cf14642f55c4d082a1ba91d2948fa92" title="Gets the position of the flow source.">FlowSource::getPosition</a>(){
<a name="l00077"></a>00077   std::vector&lt;int&gt; pos;
<a name="l00078"></a>00078   pos.push_back(<a class="code" href="class_flow_source.html#adb3bdaeaf28846562dcd80f42707e417" title="The x position of the source.">xpos</a>);
<a name="l00079"></a>00079   pos.push_back(<a class="code" href="class_flow_source.html#acbe39fd6b4c3df0fe26325edcc39c8a8" title="The y position of the source.">ypos</a>);
<a name="l00080"></a>00080   pos.push_back(<a class="code" href="class_flow_source.html#a9635d50a05d0cb2f89f3380bb59fc6a5" title="The z position of the source.">zpos</a>);
<a name="l00081"></a>00081   <span class="keywordflow">return</span> pos;
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="class_flow_source.html#a22a5f067cec60e4db23be237d15a56e2">00085</a> <span class="keywordtype">float</span> <a class="code" href="class_flow_source.html#a22a5f067cec60e4db23be237d15a56e2" title="Gets the water left in the flow source as descriebed by totalWater.">FlowSource::getWaterLeft</a>(){
<a name="l00086"></a>00086   <span class="keywordflow">return</span> <a class="code" href="class_flow_source.html#a7a4d74ebd43f9bc207833411a70f433a" title="The total water of the source.">totalWater</a>;
<a name="l00087"></a>00087 }
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="class_flow_source.html#ac3563fd62ddc0068eaf86035654ea721">00089</a> <span class="keywordtype">float</span> <a class="code" href="class_flow_source.html#ac3563fd62ddc0068eaf86035654ea721" title="Gets the radius of the flow source.">FlowSource::getRadius</a>(){
<a name="l00090"></a>00090   <span class="keywordflow">return</span> <a class="code" href="class_flow_source.html#a0fa7b53fc621d46afbe53125fec56ab7" title="The radius of the source.">radius</a>;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="class_flow_source.html#aac4ba810fbbe8810fa58a9990d946a49">00094</a> <span class="keywordtype">bool</span> <a class="code" href="class_flow_source.html#aac4ba810fbbe8810fa58a9990d946a49" title="Checks for changes in pressure after performing an update on the source.">FlowSource::getChange</a>(<span class="keywordtype">float</span> <a class="code" href="field_shader_8comp.html#a97357e98eaffc814a4a8996e8811ee20" title="timestep for simulation.">dt</a>) {
<a name="l00095"></a>00095   <span class="comment">//currPres = FlowSource::getPressure();</span>
<a name="l00096"></a>00096   <a class="code" href="class_flow_source.html#a70cbe7c173437ef03d7eec12f500199d" title="This function updates the source by progressing the internal source time. this should be called regul...">FlowSource::update</a>(dt);
<a name="l00097"></a>00097   <span class="keywordtype">float</span> newPre = <a class="code" href="class_flow_source.html#a8bfe33f49781c093cdee9fef53270393" title="This function finds the curent pressure depandeing on the internal time set by the update function...">FlowSource::getPressure</a>();
<a name="l00098"></a>00098   <span class="keywordflow">if</span>(newPre == <a class="code" href="class_flow_source.html#abb1c018deab5511c3d41440831842b99">currPres</a>){
<a name="l00099"></a>00099     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00100"></a>00100   }
<a name="l00101"></a>00101   <span class="keywordflow">else</span> {
<a name="l00102"></a>00102     <a class="code" href="class_flow_source.html#abb1c018deab5511c3d41440831842b99">currPres</a> = newPre;
<a name="l00103"></a>00103     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00104"></a>00104   }  
<a name="l00105"></a>00105 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>flowSource.cpp</b>      </li>

    <li class="footer">Generated on Tue Dec 15 2015 17:36:38 for Waterflow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
